services:
  - type: web
    name: pigeon-backend
    env: python
    buildCommand: |
      echo "üöÄ –ó–ê–ü–£–°–ö –°–ë–û–†–ö–ò..."
      echo "=================="
      
      # –î–∞–µ–º –ø—Ä–∞–≤–∞ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞
      chmod +x deploy.sh
      
      # –ó–∞–ø—É—Å–∫–∞–µ–º —Å–∫—Ä–∏–ø—Ç –¥–µ–ø–ª–æ—è
      ./deploy.sh
      
      echo "=================="
      echo "‚úÖ –°–ë–û–†–ö–ê –ó–ê–í–ï–†–®–ï–ù–ê!"
    startCommand: gunicorn pigeon.wsgi:application --bind 0.0.0.0:$PORT --workers 2 --timeout 120
    envVars:
      - key: DATABASE_URL
        fromDatabase:
          name: pigeon-db
          property: connectionString
      - key: SECRET_KEY
        generateValue: true
      - key: DEBUG
        value: false
      - key: PYTHON_VERSION
        value: 3.11.0
      - key: DISABLE_COLLECTSTATIC
        value: 0
      - key: DJANGO_SETTINGS_MODULE
        value: pigeon.settings
    autoDeploy: true
    healthCheckPath: /
    numInstances: 1

databases:
  - name: pigeon-db
    databaseName: pigeon
    user: pigeon_user
    plan: free